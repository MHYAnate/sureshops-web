
export function ShopContact({ contactDetails, bankDetails }: ShopContactProps) {
  const copyToClipboard = (text: string, label: string) => {
    navigator.clipboard.writeText(text);
    toast.success(`${label} copied!`);
  };

  const copyBankDetails = () => {
    if (!bankDetails) return;
    const details = `Bank: ${bankDetails.bankName}\nAccount Name: ${bankDetails.accountName}\nAccount Number: ${bankDetails.accountNumber}`;
    navigator.clipboard.writeText(details);
    toast.success("Bank details copied!");
  };

  return (
    <Card className="p-6">
      <h3 className="font-semibold mb-4">Contact Information</h3>

      <div className="space-y-4">
        {/* Phone */}
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="flex h-10 w-10 items-center justify-center rounded-full bg-muted">
              <Phone className="h-5 w-5" />
            </div>
            <div>
              <p className="text-sm text-muted-foreground">Phone</p>
              <p className="font-medium">{contactDetails.phone}</p>
            </div>
          </div>
          <div className="flex gap-2">
            <Button
              size="sm"
              variant="outline"
              onClick={() => window.open(`tel:${contactDetails.phone}`)}
            >
              Call
            </Button>
            <Button
              size="icon"
              variant="ghost"
              onClick={() => copyToClipboard(contactDetails.phone, "Phone")}
            >
              <Copy className="h-4 w-4" />
            </Button>
          </div>
        </div>

        {/* WhatsApp */}
        {contactDetails.whatsapp && (
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="flex h-10 w-10 items-center justify-center rounded-full bg-green-500/10">
                <MessageCircle className="h-5 w-5 text-green-600" />
              </div>
              <div>
                <p className="text-sm text-muted-foreground">WhatsApp</p>
                <p className="font-medium">{contactDetails.whatsapp}</p>
              </div>
            </div>
            <Button
              size="sm"
              className="bg-green-600 hover:bg-green-700"
              onClick={() =>
                window.open(
                  `https://wa.me/${contactDetails.whatsapp?.replace(/\D/g, "")}`
                )
              }
            >
              Chat
            </Button>
          </div>
        )}

        {/* Email */}
        {contactDetails.email && (
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="flex h-10 w-10 items-center justify-center rounded-full bg-muted">
                <Mail className="h-5 w-5" />
              </div>
              <div>
                <p className="text-sm text-muted-foreground">Email</p>
                <p className="font-medium">{contactDetails.email}</p>
              </div>
            </div>
            <Button
              size="sm"
              variant="outline"
              onClick={() => window.open(`mailto:${contactDetails.email}`)}
            >
              Email
            </Button>
          </div>
        )}

        {/* Website */}
        {contactDetails.website && (
          <div className="flex items-center justify-between">
            <div className="flex items-center gap-3">
              <div className="flex h-10 w-10 items-center justify-center rounded-full bg-muted">
                <Globe className="h-5 w-5" />
              </div>
              <div>
                <p className="text-sm text-muted-foreground">Website</p>
                <p className="font-medium truncate max-w-[200px]">
                  {contactDetails.website}
                </p>
              </div>
            </div>
            <Button
              size="sm"
              variant="outline"
              onClick={() => window.open(contactDetails.website, "_blank")}
            >
              Visit
            </Button>
          </div>
        )}

        {/* Social Links */}
        {(contactDetails.instagram || contactDetails.facebook || contactDetails.twitter) && (
          <div className="pt-4 border-t border-border">
            <p className="text-sm text-muted-foreground mb-3">Social Media</p>
            <div className="flex gap-2">
              {contactDetails.instagram && (
                <Button
                  size="icon"
                  variant="outline"
                  onClick={() =>
                    window.open(
                      `https://instagram.com/${contactDetails.instagram}`,
                      "_blank"
                    )
                  }
                >
                  <Instagram className="h-4 w-4" />
                </Button>
              )}
              {contactDetails.facebook && (
                <Button
                  size="icon"
                  variant="outline"
                  onClick={() =>
                    window.open(
                      `https://facebook.com/${contactDetails.facebook}`,
                      "_blank"
                    )
                  }
                >
                  <Facebook className="h-4 w-4" />
                </Button>
              )}
              {contactDetails.twitter && (
                <Button
                  size="icon"
                  variant="outline"
                  onClick={() =>
                    window.open(
                      `https://twitter.com/${contactDetails.twitter}`,
                      "_blank"
                    )
                  }
                >
                  <Twitter className="h-4 w-4" />
                </Button>
              )}
            </div>
          </div>
        )}

        {/* Bank Details */}
        {bankDetails && (
          <div className="pt-4 border-t border-border">
            <div className="flex items-center justify-between mb-3">
              <p className="text-sm font-medium">Bank Details for Transfer</p>
              <Button size="sm" variant="outline" onClick={copyBankDetails}>
                <Copy className="mr-2 h-4 w-4" />
                Copy All
              </Button>
            </div>
            <div className="space-y-2 text-sm bg-muted/50 rounded-lg p-4">
              <div className="flex justify-between">
                <span className="text-muted-foreground">Bank</span>
                <span className="font-medium">{bankDetails.bankName}</span>
              </div>
              <div className="flex justify-between">
                <span className="text-muted-foreground">Account Name</span>
                <span className="font-medium">{bankDetails.accountName}</span>
              </div>
              <div className="flex justify-between">
                <span className="text-muted-foreground">Account Number</span>
                <span className="font-mono font-medium">{bankDetails.accountNumber}</span>
              </div>
            </div>
          </div>
        )}
      </div>
    </Card>
  );
}
// shop-grid.tsx
import { ShopCard } from "./shop-card";
import { ShopDisplayData } from "@/types/shop-display";
import { Skeleton } from "@/components/ui";
import { EmptyState } from "@/components/common";
import { Store } from "lucide-react";

interface ShopGridProps {
  shops: ShopDisplayData[];  // ✅ Single unified type
  isLoading?: boolean;
  emptyMessage?: string;
}

export function ShopGrid({
  shops,
  isLoading,
  emptyMessage = "No shops found",
}: ShopGridProps) {
  if (isLoading) {
    return (
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {Array.from({ length: 6 }).map((_, i) => (
          <div key={i} className="space-y-3">
            <Skeleton className="h-32 w-full" />
            <Skeleton className="h-4 w-3/4" />
            <Skeleton className="h-4 w-1/2" />
          </div>
        ))}
      </div>
    );
  }

  if (shops.length === 0) {
    return (
      <EmptyState
        icon={<Store className="h-10 w-10" />}
        title={emptyMessage}
        description="Try adjusting your search or filters"
      />
    );
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {shops.map((shop) => (
        <ShopCard key={shop.id} shop={shop} />
      ))}
    </div>
  );
}
"use client";

import { MapPin, Navigation, Clock, Calendar } from "lucide-react";
import { Card, Badge, Button } from "@/components/ui";
import { LocationInfo, OperatingHours } from "@/types";
import { isOpen as checkIsOpen } from "@/lib/utils";
import { DAYS_OF_WEEK } from "@/lib/constants";

interface ShopLocationProps {
  location: LocationInfo;
  operatingHours?: OperatingHours & { isOpen?: boolean };
}

export function ShopLocation({ location, operatingHours }: ShopLocationProps) {
  const shopIsOpen = operatingHours
    ? checkIsOpen(operatingHours.openingTime, operatingHours.closingTime)
    : undefined;

  const openMaps = () => {
    if (location.coordinates) {
      const [lng, lat] = location.coordinates;
      window.open(
        `https://www.google.com/maps/search/?api=1&query=${lat},${lng}`,
        "_blank"
      );
    } else {
      const query = [
        location.shopAddress,
        location.market?.name,
        location.area.name,
        location.state.name,
      ]
        .filter(Boolean)
        .join(", ");
      window.open(
        `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`,
        "_blank"
      );
    }
  };

  return (
    <Card className="p-6">
      <div className="flex items-center justify-between mb-4">
        <h3 className="font-semibold">Location & Hours</h3>
        {shopIsOpen !== undefined && (
          <Badge variant={shopIsOpen ? "success" : "secondary"}>
            {shopIsOpen ? "Open Now" : "Closed"}
          </Badge>
        )}
      </div>

      <div className="space-y-4">
        {/* Address */}
        <div className="flex gap-3">
          <MapPin className="h-5 w-5 text-muted-foreground flex-shrink-0 mt-0.5" />
          <div>
            {location.shopNumber && (
              <p className="font-medium">{location.shopNumber}</p>
            )}
            {location.shopFloor && (
              <p className="text-sm text-muted-foreground">
                Floor: {location.shopFloor}
                {location.shopBlock && `, Block: ${location.shopBlock}`}
              </p>
            )}
            {location.market && (
              <p className="text-sm">{location.market.name}</p>
            )}
            <p className="text-sm text-muted-foreground">
              {location.area.name}, {location.state.name}
            </p>
            {location.landmark && (
              <p className="text-xs text-muted-foreground mt-1">
                Landmark: {location.landmark}
              </p>
            )}
            {location.shopAddress && (
              <p className="text-sm text-muted-foreground mt-1">
                {location.shopAddress}
              </p>
            )}
          </div>
        </div>

        {/* Get Directions */}
        <Button variant="outline" className="w-full" onClick={openMaps}>
          <Navigation className="mr-2 h-4 w-4" />
          Get Directions
        </Button>

        {/* Operating Hours */}
        {operatingHours && (
          <div className="pt-4 border-t border-border">
            <div className="flex items-center gap-2 mb-3">
              <Clock className="h-4 w-4 text-muted-foreground" />
              <span className="text-sm font-medium">Operating Hours</span>
            </div>

            {operatingHours.is24Hours ? (
              <p className="text-sm">Open 24 hours</p>
            ) : (
              <div className="flex items-center gap-2 text-sm">
                <span>{operatingHours.openingTime}</span>
                <span className="text-muted-foreground">-</span>
                <span>{operatingHours.closingTime}</span>
              </div>
            )}

            {/* Operating Days */}
            {operatingHours.operatingDays && operatingHours.operatingDays.length > 0 && (
              <div className="mt-3">
                <div className="flex items-center gap-2 mb-2">
                  <Calendar className="h-4 w-4 text-muted-foreground" />
                  <span className="text-sm font-medium">Open Days</span>
                </div>
                <div className="flex flex-wrap gap-1">
                  {DAYS_OF_WEEK.map((day) => {
                    const isOpen = operatingHours.operatingDays?.includes(day);
                    return (
                      <Badge
                        key={day}
                        variant={isOpen ? "default" : "outline"}
                        className="text-xs"
                      >
                        {day.slice(0, 3)}
                      </Badge>
                    );
                  })}
                </div>
              </div>
            )}
          </div>
        )}
      </div>
    </Card>
  );
}
export * from './login-form';
export * from './register-form';
export * from './product-form';
export * from './vendor-form';
// export * from './profile-form';
"use client";

import { Select } from "@/components/ui";
import { useLocationSelect } from "@/hooks/use-location-select";

interface LocationSelectProps {
  initialStateId?: string;
  initialAreaId?: string;
  initialMarketId?: string;
  includeMarkets?: boolean;
  showMarket?: boolean;
  onStateChange?: (stateId: string) => void;
  onAreaChange?: (areaId: string) => void;
  onMarketChange?: (marketId: string) => void;
  stateError?: string;
  areaError?: string;
  marketError?: string;
  disabled?: boolean;
}

export function LocationSelect({
  initialStateId,
  initialAreaId,
  initialMarketId,
  includeMarkets = true,
  showMarket = true,
  onStateChange,
  onAreaChange,
  onMarketChange,
  stateError,
  areaError,
  marketError,
  disabled = false,
}: LocationSelectProps) {
  const {
    states,
    areas,
    markets,
    selectedStateId,
    selectedAreaId,
    selectedMarketId,
    loadingStates,
    loadingAreas,
    loadingMarkets,
    handleStateChange: internalStateChange,
    handleAreaChange: internalAreaChange,
    handleMarketChange: internalMarketChange,
  } = useLocationSelect({
    initialStateId,
    initialAreaId,
    initialMarketId,
    includeMarkets: includeMarkets && showMarket,
  });

  const handleStateSelect = (stateId: string) => {
    internalStateChange(stateId);
    // Notify parent form
    onStateChange?.(stateId);
    onAreaChange?.("");
    onMarketChange?.("");
  };

  const handleAreaSelect = (areaId: string) => {
    internalAreaChange(areaId);
    // Notify parent form
    onAreaChange?.(areaId);
    onMarketChange?.("");
  };

  const handleMarketSelect = (marketId: string) => {
    internalMarketChange(marketId);
    // Notify parent form
    onMarketChange?.(marketId);
  };

  return (
    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
      {/* State Select */}
      <div>
        <label className="block text-sm font-medium mb-2">
          State <span className="text-destructive">*</span>
        </label>
        <Select
          value={selectedStateId}
          onChange={handleStateSelect}
          options={states.map((s) => ({ value: s.id, label: s.name }))}
          placeholder={loadingStates ? "Loading states..." : "Select state"}
          disabled={disabled || loadingStates}
          error={stateError}
        />
      </div>

      {/* Area Select */}
      <div>
        <label className="block text-sm font-medium mb-2">
          Area <span className="text-destructive">*</span>
        </label>
        <Select
          value={selectedAreaId}
          onChange={handleAreaSelect}
          options={areas.map((a) => ({ value: a.id, label: a.name }))}
          placeholder={
            loadingAreas
              ? "Loading areas..."
              : !selectedStateId
                ? "Select state first"
                : areas.length === 0
                  ? "No areas found"
                  : "Select area"
          }
          disabled={disabled || !selectedStateId || loadingAreas || areas.length === 0}
          error={areaError}
        />
        {/* Debug info — remove after confirming it works */}
        {selectedStateId && !loadingAreas && (
          <p className="text-xs text-muted-foreground mt-1">
            {areas.length} area{areas.length !== 1 ? "s" : ""} found
          </p>
        )}
      </div>

      {/* Market Select (optional) */}
      {showMarket && (
        <div>
          <label className="block text-sm font-medium mb-2">
            Market / Mall
          </label>
          <Select
            value={selectedMarketId}
            onChange={handleMarketSelect}
            options={[
              { value: "", label: "None (Home-based / Street)" },
              ...markets.map((m) => ({
                value: m.id,
                label: `${m.name}${m.type ? ` (${m.type.replace(/_/g, " ")})` : ""}`,
              })),
            ]}
            placeholder={
              loadingMarkets
                ? "Loading markets..."
                : !selectedAreaId
                  ? "Select area first"
                  : markets.length === 0
                    ? "No markets in this area"
                    : "Select market (optional)"
            }
            disabled={disabled || !selectedAreaId || loadingMarkets}
            error={marketError}
          />
        </div>
      )}
    </div>
  );
}
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { Eye, EyeOff, Mail, Lock } from "lucide-react";
import { Button, Input } from "@/components/ui";
import { loginSchema, LoginInput } from "@/lib/validations";
import { authService } from "@/services";
import { useAuthStore } from "@/store";
import toast from "react-hot-toast";

export function LoginForm() {
  const router = useRouter();
  const { setUser } = useAuthStore();
  const [showPassword, setShowPassword] = useState(false);
  const [isLoading, setIsLoading] = useState(false);

  const {
    register,
    handleSubmit,
    formState: { errors },
  } = useForm<LoginInput>({
    resolver: zodResolver(loginSchema),
  });

  const onSubmit = async (data: LoginInput) => {
    setIsLoading(true);
    try {
      const response = await authService.login(data);
      setUser(response.user);
      toast.success("Welcome back!");
      router.push("/");
    } catch (error: any) {
      toast.error(error.response?.data?.message || "Login failed");
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
      <div className="space-y-4">
        <div>
          <label className="block text-sm font-medium mb-2">Email</label>
          <Input
            type="email"
            placeholder="Enter your email"
            {...register("email")}
            error={errors.email?.message}
            leftIcon={<Mail className="h-5 w-5" />}
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Password</label>
          <Input
            type={showPassword ? "text" : "password"}
            placeholder="Enter your password"
            {...register("password")}
            error={errors.password?.message}
            leftIcon={<Lock className="h-5 w-5" />}
            rightIcon={
              <button
                type="button"
                onClick={() => setShowPassword(!showPassword)}
                className="hover:text-foreground"
              >
                {showPassword ? (
                  <EyeOff className="h-5 w-5" />
                ) : (
                  <Eye className="h-5 w-5" />
                )}
              </button>
            }
          />
        </div>
      </div>

      <div className="flex items-center justify-between">
        <label className="flex items-center gap-2 cursor-pointer">
          <input type="checkbox" className="rounded border-input" />
          <span className="text-sm">Remember me</span>
        </label>
        <Link
          href="/forgot-password"
          className="text-sm text-primary hover:underline"
        >
          Forgot password?
        </Link>
      </div>

      <Button type="submit" className="w-full" size="lg" isLoading={isLoading}>
        Sign In
      </Button>

      <p className="text-center text-sm text-muted-foreground">
        Don't have an account?{" "}
        <Link href="/register" className="text-primary hover:underline font-medium">
          Sign up
        </Link>
      </p>
    </form>
  );
}"use client";

import { useState, useEffect } from "react";
import { useForm, Controller } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { Button, Input, Select } from "@/components/ui";
import { ImageUpload } from "@/components/common/image-upload";
import { X } from "lucide-react";

const productSchema = z.object({
  name: z.string().min(2, "Product name is required"),
  description: z.string().optional(),
  type: z.enum(["sale", "lease", "rent", "service"]),
  price: z.number().min(0, "Price must be positive"),
  originalPrice: z.number().optional(),
  category: z.string().min(1, "Category is required"),
  subcategory: z.string().optional(),
  brand: z.string().optional(),
  sku: z.string().optional(),
  barcode: z.string().optional(),
  quantity: z.number().min(0, "Quantity must be 0 or more"),
  unit: z.string().optional(),
  inStock: z.boolean(),
  images: z.array(z.string()),
  tags: z.array(z.string()),
  specifications: z.record(z.string(), z.any()).optional(),
});

type ProductInput = z.infer<typeof productSchema>;

interface ProductFormProps {
  initialData?: Partial<ProductInput> & { id?: string };
  onSubmit: (data: ProductInput) => Promise<void>;
  isLoading?: boolean;
}

const PRODUCT_TYPE_OPTIONS = [
  { value: "sale", label: "For Sale" },
  { value: "lease", label: "For Lease" },
  { value: "rent", label: "For Rent" },
  { value: "service", label: "Service" },
];

const CATEGORY_OPTIONS = [
  "Electronics",
  "Fashion",
  "Phones & Tablets",
  "Computers & Accessories",
  "Home & Garden",
  "Health & Beauty",
  "Sports & Fitness",
  "Food & Groceries",
  "Baby & Kids",
  "Automotive",
  "Books & Media",
  "Office Supplies",
  "Building Materials",
  "Agriculture",
  "Services",
  "Other",
];

export function ProductForm({
  initialData,
  onSubmit,
  isLoading,
}: ProductFormProps) {
  const [tagInput, setTagInput] = useState("");

  const {
    register,
    handleSubmit,
    formState: { errors },
    setValue,
    watch,
    control,
    reset,
  } = useForm<ProductInput>({
    resolver: zodResolver(productSchema),
    defaultValues: {
      name: initialData?.name || "",
      description: initialData?.description || "",
      type: initialData?.type || "sale",
      price: initialData?.price ?? 0,
      originalPrice: initialData?.originalPrice,
      category: initialData?.category || "",
      subcategory: initialData?.subcategory || "",
      brand: initialData?.brand || "",
      sku: initialData?.sku || "",
      barcode: initialData?.barcode || "",
      quantity: initialData?.quantity ?? 0,
      unit: initialData?.unit || "",
      inStock: initialData?.inStock ?? true,
      images: initialData?.images || [],
      tags: initialData?.tags || [],
      specifications: initialData?.specifications || {},
    },
  });

  const watchedTags = watch("tags") || [];
  const watchedImages = watch("images") || [];
  const watchedInStock = watch("inStock");

  // Reset form when initialData changes (edit mode)
  useEffect(() => {
    if (initialData) {
      reset({
        name: initialData.name || "",
        description: initialData.description || "",
        type: initialData.type || "sale",
        price: initialData.price ?? 0,
        originalPrice: initialData.originalPrice,
        category: initialData.category || "",
        subcategory: initialData.subcategory || "",
        brand: initialData.brand || "",
        sku: initialData.sku || "",
        barcode: initialData.barcode || "",
        quantity: initialData.quantity ?? 0,
        unit: initialData.unit || "",
        inStock: initialData.inStock ?? true,
        images: initialData.images || [],
        tags: initialData.tags || [],
        specifications: initialData.specifications || {},
      });
    }
  }, [initialData, reset]);

  // --- Image handlers ---
  const handleImagesChange = (newImages: string[]) => {
    setValue("images", newImages, { shouldValidate: true });
  };

  // --- Tag handlers ---
  const handleAddTag = () => {
    const tag = tagInput.trim();
    if (tag && !watchedTags.includes(tag)) {
      setValue("tags", [...watchedTags, tag]);
      setTagInput("");
    }
  };

  const handleRemoveTag = (tagToRemove: string) => {
    setValue(
      "tags",
      watchedTags.filter((t) => t !== tagToRemove)
    );
  };

  const handleTagKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === "Enter") {
      e.preventDefault();
      handleAddTag();
    }
    if (e.key === "Backspace" && tagInput === "" && watchedTags.length > 0) {
      handleRemoveTag(watchedTags[watchedTags.length - 1]);
    }
  };

  // --- Submit handler ---
  const handleFormSubmit = async (data: ProductInput) => {
    const cleanData = { ...data };
    if (!cleanData.description) delete cleanData.description;
    if (!cleanData.subcategory) delete cleanData.subcategory;
    if (!cleanData.brand) delete cleanData.brand;
    if (!cleanData.sku) delete cleanData.sku;
    if (!cleanData.barcode) delete cleanData.barcode;
    if (!cleanData.unit) delete cleanData.unit;
    if (
      cleanData.originalPrice === undefined ||
      cleanData.originalPrice === null ||
      isNaN(cleanData.originalPrice)
    ) {
      delete cleanData.originalPrice;
    }

    await onSubmit(cleanData);
  };

  return (
    <form onSubmit={handleSubmit(handleFormSubmit)} className="space-y-8">
      {/* ===== Product Images ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Product Images
        </h3>
        <ImageUpload
          images={watchedImages}
          onChange={handleImagesChange}
          maxImages={5}
        />
      </div>

      {/* ===== Basic Information ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Basic Information
        </h3>

        <div>
          <label className="block text-sm font-medium mb-2">
            Product Name <span className="text-destructive">*</span>
          </label>
          <Input
            {...register("name")}
            placeholder="e.g., iPhone 15 Pro Max 256GB"
            error={errors.name?.message}
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Description</label>
          <textarea
            {...register("description")}
            className="w-full rounded-lg border border-input bg-background px-4 py-3 text-sm min-h-[120px] focus:outline-none focus:ring-2 focus:ring-ring resize-y"
            placeholder="Describe your product — condition, features, what's included..."
          />
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">
              Listing Type <span className="text-destructive">*</span>
            </label>
            <Controller
              name="type"
              control={control}
              render={({ field }) => (
                <Select
                  value={field.value}
                  onChange={field.onChange}
                  options={PRODUCT_TYPE_OPTIONS}
                  error={errors.type?.message}
                />
              )}
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Brand</label>
            <Input
              {...register("brand")}
              placeholder="e.g., Apple, Samsung, Nike"
            />
          </div>
        </div>
      </div>

      {/* ===== Category ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Category
        </h3>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">
              Category <span className="text-destructive">*</span>
            </label>
            <Controller
              name="category"
              control={control}
              render={({ field }) => (
                <Select
                  value={field.value}
                  onChange={field.onChange}
                  options={CATEGORY_OPTIONS.map((c) => ({
                    value: c,
                    label: c,
                  }))}
                  placeholder="Select category"
                  error={errors.category?.message}
                />
              )}
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">
              Subcategory
            </label>
            <Input
              {...register("subcategory")}
              placeholder="e.g., Smartphones, Running Shoes"
            />
          </div>
        </div>
      </div>

      {/* ===== Pricing & Stock ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Pricing & Stock
        </h3>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">
              Price (₦) <span className="text-destructive">*</span>
            </label>
            <Input
              type="number"
              step="0.01"
              min="0"
              {...register("price", { valueAsNumber: true })}
              placeholder="0.00"
              error={errors.price?.message}
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">
              Original Price (₦)
              <span className="text-xs text-muted-foreground ml-1">
                (for discounts)
              </span>
            </label>
            <Input
              type="number"
              step="0.01"
              min="0"
              {...register("originalPrice", { valueAsNumber: true })}
              placeholder="0.00"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Quantity</label>
            <Input
              type="number"
              min="0"
              {...register("quantity", { valueAsNumber: true })}
              placeholder="0"
              error={errors.quantity?.message}
            />
          </div>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">Unit</label>
            <Input
              {...register("unit")}
              placeholder="e.g., piece, kg, pack, dozen"
            />
          </div>

          <div className="flex items-center gap-3 pt-6">
            <label className="relative inline-flex items-center cursor-pointer">
              <input
                type="checkbox"
                {...register("inStock")}
                className="sr-only peer"
              />
              <div className="w-11 h-6 bg-muted peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-ring rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary" />
              <span className="ml-3 text-sm font-medium">
                {watchedInStock ? "In Stock" : "Out of Stock"}
              </span>
            </label>
          </div>
        </div>
      </div>

      {/* ===== Product Identification ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Product Identification
          <span className="text-sm font-normal text-muted-foreground ml-2">
            (Optional — helps match for price comparison)
          </span>
        </h3>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">SKU</label>
            <Input {...register("sku")} placeholder="Stock Keeping Unit" />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Barcode</label>
            <Input {...register("barcode")} placeholder="UPC / EAN barcode" />
          </div>
        </div>
      </div>

      {/* ===== Tags ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Tags
          <span className="text-sm font-normal text-muted-foreground ml-2">
            (Help customers find your product)
          </span>
        </h3>

        <div>
          <div className="flex gap-2">
            <Input
              value={tagInput}
              onChange={(e) => setTagInput(e.target.value)}
              onKeyDown={handleTagKeyDown}
              placeholder="Type a tag and press Enter"
              className="flex-1"
            />
            <Button
              type="button"
              variant="outline"
              onClick={handleAddTag}
              disabled={!tagInput.trim()}
            >
              Add
            </Button>
          </div>

          {watchedTags.length > 0 && (
            <div className="flex flex-wrap gap-2 mt-3">
              {watchedTags.map((tag) => (
                <span
                  key={tag}
                  className="inline-flex items-center gap-1 px-3 py-1 rounded-full bg-primary/10 text-primary text-sm"
                >
                  {tag}
                  <button
                    type="button"
                    onClick={() => handleRemoveTag(tag)}
                    className="ml-1 text-primary/60 hover:text-primary"
                  >
                    <X className="h-3 w-3" />
                  </button>
                </span>
              ))}
            </div>
          )}
        </div>
      </div>

      {/* ===== Submit ===== */}
      <div className="pt-4 border-t border-border">
        <Button
          type="submit"
          size="lg"
          isLoading={isLoading}
          className="w-full"
        >
          {initialData?.id ? "Update Product" : "Add Product"}
        </Button>
      </div>
    </form>
  );
}"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import Link from "next/link";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { Eye, EyeOff, Mail, Lock, User, Phone } from "lucide-react";
import { Button, Input } from "@/components/ui";
import { registerSchema, RegisterInput } from "@/lib/validations";
import { authService } from "@/services";
import { useAuthStore } from "@/store";
import toast from "react-hot-toast";

export function RegisterForm() {
  const router = useRouter();
  const { setUser } = useAuthStore();
  const [showPassword, setShowPassword] = useState(false);
  const [isLoading, setIsLoading] = useState(false);

  const {
    register,
    handleSubmit,
    formState: { errors },
  } = useForm<RegisterInput>({
    resolver: zodResolver(registerSchema),
  });

  const onSubmit = async (data: RegisterInput) => {
    setIsLoading(true);
    try {
      const response = await authService.register(data);
      setUser(response.user);
      toast.success("Account created successfully!");
      router.push("/");
    } catch (error: any) {
      toast.error(error.response?.data?.message || "Registration failed");
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
      <div className="space-y-4">
        <div className="grid grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">First Name</label>
            <Input
              type="text"
              placeholder="John"
              {...register("firstName")}
              error={errors.firstName?.message}
              leftIcon={<User className="h-5 w-5" />}
            />
          </div>
          <div>
            <label className="block text-sm font-medium mb-2">Last Name</label>
            <Input
              type="text"
              placeholder="Doe"
              {...register("lastName")}
              error={errors.lastName?.message}
            />
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Email</label>
          <Input
            type="email"
            placeholder="john@example.com"
            {...register("email")}
            error={errors.email?.message}
            leftIcon={<Mail className="h-5 w-5" />}
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Phone Number</label>
          <Input
            type="tel"
            placeholder="08012345678"
            {...register("phone")}
            error={errors.phone?.message}
            leftIcon={<Phone className="h-5 w-5" />}
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Password</label>
          <Input
            type={showPassword ? "text" : "password"}
            placeholder="Create a password"
            {...register("password")}
            error={errors.password?.message}
            leftIcon={<Lock className="h-5 w-5" />}
            rightIcon={
              <button
                type="button"
                onClick={() => setShowPassword(!showPassword)}
                className="hover:text-foreground"
              >
                {showPassword ? (
                  <EyeOff className="h-5 w-5" />
                ) : (
                  <Eye className="h-5 w-5" />
                )}
              </button>
            }
          />
        </div>
      </div>

      <div className="flex items-start gap-2">
        <input
          type="checkbox"
          required
          className="mt-1 rounded border-input"
        />
        <span className="text-sm text-muted-foreground">
          I agree to the{" "}
          <Link href="/terms" className="text-primary hover:underline">
            Terms of Service
          </Link>{" "}
          and{" "}
          <Link href="/privacy" className="text-primary hover:underline">
            Privacy Policy
          </Link>
        </span>
      </div>

      <Button type="submit" className="w-full" size="lg" isLoading={isLoading}>
        Create Account
      </Button>

      <p className="text-center text-sm text-muted-foreground">
        Already have an account?{" "}
        <Link href="/login" className="text-primary hover:underline font-medium">
          Sign in
        </Link>
      </p>
    </form>
  );
}"use client";

import { useEffect, useCallback } from "react";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { Button, Input, Select } from "@/components/ui";
import { LocationSelect } from "@/components/forms/location-select";
import { vendorSchema, VendorInput } from "@/lib/validations";
import { VENDOR_TYPES, NIGERIAN_BANKS } from "@/lib/constants";

interface VendorFormProps {
  initialData?: Partial<VendorInput>;
  onSubmit: (data: VendorInput) => Promise<void>;
  isLoading?: boolean;
}

export function VendorForm({ initialData, onSubmit, isLoading }: VendorFormProps) {
  const {
    register,
    handleSubmit,
    formState: { errors },
    setValue,
    watch,
    reset,
  } = useForm<VendorInput>({
    resolver: zodResolver(vendorSchema),
    defaultValues: {
      businessName: "",
      businessDescription: "",
      vendorType: "market_shop",
      stateId: "",
      areaId: "",
      marketId: "",
      shopNumber: "",
      shopFloor: "",
      shopBlock: "",
      shopAddress: "",
      landmark: "",
      contactDetails: {
        phone: "",
        alternatePhone: "",
        whatsapp: "",
        email: "",
        instagram: "",
        facebook: "",
        twitter: "",
        website: "",
      },
      bankDetails: {
        bankName: "",
        accountName: "",
        accountNumber: "",
        bankCode: "",
      },
      operatingHours: {
        openingTime: "",
        closingTime: "",
        operatingDays: [],
      },
      categories: [],
      tags: [],
      ...initialData,
    },
  });

  const vendorType = watch("vendorType");

  // Reset form when initialData changes (edit mode)
  useEffect(() => {
    if (initialData) {
      reset({
        businessName: "",
        businessDescription: "",
        vendorType: "market_shop",
        stateId: "",
        areaId: "",
        marketId: "",
        shopNumber: "",
        shopFloor: "",
        shopBlock: "",
        shopAddress: "",
        landmark: "",
        contactDetails: {
          phone: "",
          alternatePhone: "",
          whatsapp: "",
          email: "",
          instagram: "",
          facebook: "",
          twitter: "",
          website: "",
        },
        bankDetails: {
          bankName: "",
          accountName: "",
          accountNumber: "",
          bankCode: "",
        },
        operatingHours: {
          openingTime: "",
          closingTime: "",
          operatingDays: [],
        },
        categories: [],
        tags: [],
        ...initialData,
      });
    }
  }, [initialData, reset]);

  // ✅ Stable callbacks — won't cause LocationSelect re-renders
  const handleLocationStateChange = useCallback(
    (stateId: string) => {
      setValue("stateId", stateId, { shouldValidate: true });
    },
    [setValue]
  );

  const handleLocationAreaChange = useCallback(
    (areaId: string) => {
      setValue("areaId", areaId, { shouldValidate: true });
    },
    [setValue]
  );

  const handleLocationMarketChange = useCallback(
    (marketId: string) => {
      setValue("marketId", marketId || undefined, { shouldValidate: true });
    },
    [setValue]
  );

  return (
    <form onSubmit={handleSubmit(onSubmit)} className="space-y-8">
      {/* ===== Business Info ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Business Information
        </h3>

        <div>
          <label className="block text-sm font-medium mb-2">
            Business Name <span className="text-destructive">*</span>
          </label>
          <Input
            {...register("businessName")}
            error={errors.businessName?.message}
            placeholder="Your shop or business name"
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Description</label>
          <textarea
            {...register("businessDescription")}
            className="w-full rounded-lg border border-input bg-background px-4 py-3 text-sm min-h-[100px] focus:outline-none focus:ring-2 focus:ring-ring"
            placeholder="Tell customers about your business, what you sell, specialties..."
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">
            Vendor Type <span className="text-destructive">*</span>
          </label>
          <Select
            value={vendorType}
            onChange={(value) =>
              setValue("vendorType", value as any, { shouldValidate: true })
            }
            options={VENDOR_TYPES}
          />
          <p className="text-xs text-muted-foreground mt-1">
            Choose the type that best describes your business location
          </p>
        </div>
      </div>

      {/* ===== Location ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Location
        </h3>

        <LocationSelect
          initialStateId={initialData?.stateId}
          initialAreaId={initialData?.areaId}
          initialMarketId={initialData?.marketId}
          onStateChange={handleLocationStateChange}
          onAreaChange={handleLocationAreaChange}
          onMarketChange={handleLocationMarketChange}
          stateError={errors.stateId?.message}
          areaError={errors.areaId?.message}
        />

        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">
              Shop Number
            </label>
            <Input
              {...register("shopNumber")}
              placeholder="e.g., Shop 45, Stall 12"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Floor</label>
            <Input
              {...register("shopFloor")}
              placeholder="e.g., Ground Floor, 2nd Floor"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Block</label>
            <Input
              {...register("shopBlock")}
              placeholder="e.g., Block A, Plaza B"
            />
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Shop Address</label>
          <Input
            {...register("shopAddress")}
            placeholder="Full address for customers to find you"
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">Landmark</label>
          <Input
            {...register("landmark")}
            placeholder="Nearby landmark for easy location"
          />
        </div>
      </div>

      {/* ===== Contact Details ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Contact Information
        </h3>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">
              Phone Number <span className="text-destructive">*</span>
            </label>
            <Input
              {...register("contactDetails.phone")}
              placeholder="08012345678"
              error={errors.contactDetails?.phone?.message}
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">
              WhatsApp Number
            </label>
            <Input
              {...register("contactDetails.whatsapp")}
              placeholder="WhatsApp number (if different)"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Email</label>
            <Input
              type="email"
              {...register("contactDetails.email")}
              placeholder="business@example.com"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Website</label>
            <Input
              {...register("contactDetails.website")}
              placeholder="https://yourwebsite.com"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Instagram</label>
            <Input
              {...register("contactDetails.instagram")}
              placeholder="@yourusername"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">Facebook</label>
            <Input
              {...register("contactDetails.facebook")}
              placeholder="facebook.com/yourpage"
            />
          </div>
        </div>
      </div>

      {/* ===== Bank Details ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Bank Details
          <span className="text-sm font-normal text-muted-foreground ml-2">
            (For customers to make direct payments)
          </span>
        </h3>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">Bank Name</label>
            <Select
              value={watch("bankDetails.bankName") || ""}
              onChange={(value) =>
                setValue("bankDetails.bankName", value, {
                  shouldValidate: true,
                })
              }
              options={[
                { value: "", label: "Select bank" },
                ...NIGERIAN_BANKS.map((bank) => ({
                  value: bank,
                  label: bank,
                })),
              ]}
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">
              Account Name
            </label>
            <Input
              {...register("bankDetails.accountName")}
              placeholder="Account holder name"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">
              Account Number
            </label>
            <Input
              {...register("bankDetails.accountNumber")}
              placeholder="10-digit account number"
              maxLength={10}
            />
          </div>
        </div>
      </div>

      {/* ===== Operating Hours ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Operating Hours
        </h3>

        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label className="block text-sm font-medium mb-2">
              Opening Time
            </label>
            <Input
              type="time"
              {...register("operatingHours.openingTime")}
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-2">
              Closing Time
            </label>
            <Input
              type="time"
              {...register("operatingHours.closingTime")}
            />
          </div>
        </div>

        <div>
          <label className="block text-sm font-medium mb-2">
            Operating Days
          </label>
          <div className="flex flex-wrap gap-2">
            {[
              "Monday",
              "Tuesday",
              "Wednesday",
              "Thursday",
              "Friday",
              "Saturday",
              "Sunday",
            ].map((day) => (
              <label
                key={day}
                className="flex items-center gap-2 px-3 py-2 rounded-lg border border-input hover:bg-muted cursor-pointer"
              >
                <input
                  type="checkbox"
                  value={day}
                  {...register("operatingHours.operatingDays")}
                  className="rounded border-input"
                />
                <span className="text-sm">{day.slice(0, 3)}</span>
              </label>
            ))}
          </div>
        </div>
      </div>

      {/* ===== Categories ===== */}
      <div className="space-y-4">
        <h3 className="text-lg font-semibold border-b border-border pb-2">
          Product Categories
        </h3>
        <p className="text-sm text-muted-foreground">
          Select the categories of products you sell
        </p>

        <div className="flex flex-wrap gap-2">
          {[
            "Electronics",
            "Fashion",
            "Phones",
            "Computers",
            "Accessories",
            "Home & Garden",
            "Health & Beauty",
            "Sports",
            "Food & Groceries",
            "Baby & Kids",
            "Automotive",
            "Books",
          ].map((category) => (
            <label
              key={category}
              className="flex items-center gap-2 px-3 py-2 rounded-lg border border-input hover:bg-muted cursor-pointer"
            >
              <input
                type="checkbox"
                value={category}
                {...register("categories")}
                className="rounded border-input"
              />
              <span className="text-sm">{category}</span>
            </label>
          ))}
        </div>
      </div>

      {/* ===== Submit ===== */}
      <div className="pt-4 border-t border-border">
        <Button
          type="submit"
          size="lg"
          isLoading={isLoading}
          className="w-full"
        >
          {initialData ? "Update Shop" : "Create Shop"}
        </Button>
      </div>
    </form>
  );
}
// src/app/(vendor)/vendor/products/[id]/page.tsx
"use client";

import { useRouter } from "next/navigation";
import { useQuery } from "@tanstack/react-query";
import { Card } from "@/components/ui";
import { BackButton, LoadingState } from "@/components/common";
import { ProductForm } from "@/components/forms/product-form";
import { useUpdateProduct } from "@/hooks";
import { productService } from "@/services";

interface EditProductPageProps {
  params: { id: string };
}

export default function EditProductPage({ params }: EditProductPageProps) {
  const router = useRouter();
  const updateProduct = useUpdateProduct();

  const { data: product, isLoading } = useQuery({
    queryKey: ["product", params.id],
    queryFn: () => productService.getById(params.id),
    enabled: !!params.id,
  });

  const handleSubmit = async (data: any) => {
    try {
      await updateProduct.mutateAsync({ id: params.id, data });
      router.push("/vendor/products");
    } catch (error) {
      // handled by mutation
    }
  };

  if (isLoading) {
    return (
      <div className="space-y-6">
        <BackButton label="Back to Products" href="/vendor/products" />
        <LoadingState />
      </div>
    );
  }

  if (!product) {
    return (
      <div className="space-y-6">
        <BackButton label="Back to Products" href="/vendor/products" />
        <p className="text-muted-foreground">Product not found</p>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      <BackButton label="Back to Products" href="/vendor/products" />

      <div>
        <h1 className="text-2xl font-bold">Edit Product</h1>
        <p className="text-muted-foreground">
          Update details for {product.name}
        </p>
      </div>

      <Card className="p-6">
        <ProductForm
          initialData={{
            id: product.id,
            name: product.name,
            description: product.description,
            type: product.type as any,
            price: product.price,
            originalPrice: product.originalPrice,
            category: product.category,
            subcategory: product.subcategory,
            brand: product.brand,
            sku: product.sku,
            barcode: product.barcode,
            quantity: product.quantity,
            unit: product.unit,
            inStock: product.inStock,
            images: product.images || [],
            tags: product.tags || [],
            specifications: product.specifications,
          }}
          onSubmit={handleSubmit}
          isLoading={updateProduct.isPending}
        />
      </Card>
    </div>
  );
}
"use client";

import { useRouter } from "next/navigation";
import { Card } from "@/components/ui";
import { BackButton } from "@/components/common";
import { ProductForm } from "@/components/forms/product-form";
import { useCreateProduct } from "@/hooks";

export default function NewProductPage() {
  const router = useRouter();
  const createProduct = useCreateProduct();

  const handleSubmit = async (data: any) => {
    try {
      await createProduct.mutateAsync(data);
      router.push("/vendor/products");
    } catch (error) {
      // Error handled by mutation
    }
  };

  return (
    <div className="space-y-6">
      <BackButton label="Back to Products" href="/vendor/products" />

      <div>
        <h1 className="text-2xl font-bold">Add New Product</h1>
        <p className="text-muted-foreground">
          Add a new product to your inventory
        </p>
      </div>

      <Card className="p-6">
        <ProductForm
          onSubmit={handleSubmit}
          isLoading={createProduct.isPending}
        />
      </Card>
    </div>
  );
}
"use client";

import { useState } from "react";
import Link from "next/link";
import Image from "next/image";
import { Plus, Edit, Trash2, MoreHorizontal, Eye } from "lucide-react";
import { Card, Button, Badge, Input } from "@/components/ui";
import { LoadingState, EmptyState, Pagination } from "@/components/common";
import { useMyProducts, useDeleteProduct } from "@/hooks";
import { formatPrice } from "@/lib/utils";

export default function VendorProductsPage() {
  const [search, setSearch] = useState("");
  const { data: products, isLoading } = useMyProducts();
  const deleteProduct = useDeleteProduct();

  const filteredProducts = products?.filter((p) =>
    p.name.toLowerCase().includes(search.toLowerCase())
  );

  if (isLoading) {
    return <LoadingState />;
  }

  return (
    <div className="space-y-6">
      <div className="flex items-center justify-between">
        <div>
          <h1 className="text-2xl font-bold">My Products</h1>
          <p className="text-muted-foreground">
            Manage your product listings
          </p>
        </div>
        <Button asChild>
          <Link href="/vendor/products/new">
            <Plus className="mr-2 h-4 w-4" />
            Add Product
          </Link>
        </Button>
      </div>

      {/* Search */}
      <Input
        placeholder="Search products..."
        value={search}
        onChange={(e) => setSearch(e.target.value)}
        className="max-w-sm"
      />

      {/* Products Table */}
      {filteredProducts && filteredProducts.length > 0 ? (
        <Card>
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead>
                <tr className="border-b border-border">
                  <th className="text-left p-4 font-medium">Product</th>
                  <th className="text-left p-4 font-medium">Price</th>
                  <th className="text-left p-4 font-medium">Status</th>
                  <th className="text-left p-4 font-medium">Stock</th>
                  <th className="text-left p-4 font-medium">Views</th>
                  <th className="text-right p-4 font-medium">Actions</th>
                </tr>
              </thead>
              <tbody>
                {filteredProducts.map((product) => (
                  <tr key={product.id} className="border-b border-border last:border-0">
                    <td className="p-4">
                      <div className="flex items-center gap-3">
                        <div className="relative h-12 w-12 rounded-lg bg-muted overflow-hidden">
                          {product.images?.[0] ? (
                            <Image
                              src={product.images[0]}
                              alt={product.name}
                              fill
                              className="object-cover"
                            />
                          ) : (
                            <div className="flex h-full items-center justify-center text-xl">
                              📦
                            </div>
                          )}
                        </div>
                        <div>
                          <p className="font-medium line-clamp-1">{product.name}</p>
                          <p className="text-xs text-muted-foreground">
                            {product.category}
                          </p>
                        </div>
                      </div>
                    </td>
                    <td className="p-4">
                      <span className="font-medium">
                        {formatPrice(product.price)}
                      </span>
                    </td>
                    <td className="p-4">
                      <Badge
                        variant={
                          product.status === "approved"
                            ? "success"
                            : product.status === "pending"
                            ? "warning"
                            : "destructive"
                        }
                      >
                        {product.status}
                      </Badge>
                    </td>
                    <td className="p-4">
                      <Badge variant={product.inStock ? "success" : "destructive"}>
                        {product.inStock ? `${product.quantity} in stock` : "Out of stock"}
                      </Badge>
                    </td>
                    <td className="p-4 text-muted-foreground">
                      <div className="flex items-center gap-1">
                        <Eye className="h-4 w-4" />
                        {product.views}
                      </div>
                    </td>
                    <td className="p-4 text-right">
                      <div className="flex items-center justify-end gap-2">
                        <Button variant="ghost" size="icon" asChild>
                          <Link href={`/vendor/products/${product.id}`}>
                            <Edit className="h-4 w-4" />
                          </Link>
                        </Button>
                        <Button
                          variant="ghost"
                          size="icon"
                          onClick={() => {
                            if (confirm("Delete this product?")) {
                              deleteProduct.mutate(product.id);
                            }
                          }}
                        >
                          <Trash2 className="h-4 w-4 text-destructive" />
                        </Button>
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </Card>
      ) : (
        <EmptyState
          icon={<Plus className="h-10 w-10" />}
          title="No products yet"
          description="Add your first product to start selling"
          action={{
            label: "Add Product",
            onClick: () => window.location.href = "/vendor/products/new",
          }}
        />
      )}
    </div>
  );
}
"use client";

import { Package, Eye, Star, TrendingUp } from "lucide-react";
import { Card } from "@/components/ui";
import { useMyShop, useMyProducts } from "@/hooks";
import { LoadingState } from "@/components/common";
import { formatNumber } from "@/lib/utils";

export default function VendorDashboardPage() {
  const { data: shop, isLoading: shopLoading } = useMyShop();
  const { data: products, isLoading: productsLoading } = useMyProducts();

  if (shopLoading || productsLoading) {
    return <LoadingState />;
  }

  const stats = [
    {
      label: "Total Products",
      value: products?.length || 0,
      icon: Package,
      trend: "+12%",
    },
    {
      label: "Total Views",
      value: shop?.totalViews || 0,
      icon: Eye,
      trend: "+8%",
    },
    {
      label: "Rating",
      value: shop?.rating?.toFixed(1) || "0.0",
      icon: Star,
      trend: "+0.2",
    },
    // {
    //   label: "Search Appearances",
    //   value: shop?.searchAppearances || 0,
    //   icon: TrendingUp,
    //   trend: "+15%",
    // },
  ];

  return (
    <div className="space-y-8">
      <div>
        <h1 className="text-2xl font-bold">Dashboard</h1>
        <p className="text-muted-foreground">
          Welcome back, {shop?.businessName || "Vendor"}
        </p>
      </div>

      {/* Stats Grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        {stats.map((stat) => {
          const Icon = stat.icon;
          return (
            <Card key={stat.label} className="p-6">
              <div className="flex items-center justify-between">
                <div>
                  <p className="text-sm text-muted-foreground">{stat.label}</p>
                  <p className="text-2xl font-bold mt-1">
                    {typeof stat.value === "number"
                      ? formatNumber(stat.value)
                      : stat.value}
                  </p>
                </div>
                <div className="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center">
                  <Icon className="h-6 w-6" />
                </div>
              </div>
              <p className="text-sm text-green-600 mt-2">{stat.trend} this month</p>
            </Card>
          );
        })}
      </div>

      {/* Quick Actions */}
      <Card className="p-6">
        <h2 className="font-semibold mb-4">Quick Actions</h2>
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <a
            href="/vendor/products/new"
            className="p-4 rounded-lg border border-border hover:bg-muted transition-colors text-center"
          >
            <Package className="h-6 w-6 mx-auto mb-2" />
            <span className="text-sm">Add Product</span>
          </a>
          <a
            href="/vendor/products"
            className="p-4 rounded-lg border border-border hover:bg-muted transition-colors text-center"
          >
            <Eye className="h-6 w-6 mx-auto mb-2" />
            <span className="text-sm">View Products</span>
          </a>
          <a
            href="/vendor/settings"
            className="p-4 rounded-lg border border-border hover:bg-muted transition-colors text-center"
          >
            <Star className="h-6 w-6 mx-auto mb-2" />
            <span className="text-sm">Shop Settings</span>
          </a>
          <a
            href={`/shops/${shop?.id}`}
            className="p-4 rounded-lg border border-border hover:bg-muted transition-colors text-center"
          >
            <TrendingUp className="h-6 w-6 mx-auto mb-2" />
            <span className="text-sm">View Shop</span>
          </a>
        </div>
      </Card>
    </div>
  );
}
"use client";

import { useState } from "react";
import { Card, Button } from "@/components/ui";
import { LoadingState } from "@/components/common";
import { VendorForm } from "@/components/forms/vendor-form";
// import { ImageUpload } from "@/components/common/image-upload";
import { useMyShop, useUpdateVendor } from "@/hooks";
import { uploadService } from "@/services";
import toast from "react-hot-toast";

export default function VendorSettingsPage() {
  const { data: shop, isLoading, refetch } = useMyShop();
  const updateVendor = useUpdateVendor();
  const [uploadingLogo, setUploadingLogo] = useState(false);
  const [uploadingEntrance, setUploadingEntrance] = useState(false);

  if (isLoading) {
    return <LoadingState />;
  }

  if (!shop) {
    return <div>Shop not found</div>;
  }

  const handleSubmit = async (data: any) => {
    await updateVendor.mutateAsync({ id: shop.id, data });
  };

  const handleLogoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;

    setUploadingLogo(true);
    try {
      const result = await uploadService.uploadShopLogo(file);
      await updateVendor.mutateAsync({
        id: shop.id,
        data: { shopImages: { ...shop.shopImages, logo: result.url } },
      });
      refetch();
      toast.success("Logo updated successfully");
    } catch (error) {
      toast.error("Failed to upload logo");
    } finally {
      setUploadingLogo(false);
    }
  };

  const handleEntranceUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (!file) return;

    setUploadingEntrance(true);
    try {
      const result = await uploadService.uploadShopEntrance(file);
      await updateVendor.mutateAsync({
        id: shop.id,
        data: { shopImages: { ...shop.shopImages, entrancePhoto: result.url } },
      });
      refetch();
      toast.success("Entrance photo updated successfully");
    } catch (error) {
      toast.error("Failed to upload photo");
    } finally {
      setUploadingEntrance(false);
    }
  };

  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-2xl font-bold">Shop Settings</h1>
        <p className="text-muted-foreground">
          Manage your shop information and appearance
        </p>
      </div>

      {/* Shop Images */}
      <Card className="p-6">
        <h2 className="font-semibold mb-4">Shop Images</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          {/* Logo */}
          <div>
            <label className="block text-sm font-medium mb-2">Shop Logo</label>
            <div className="relative aspect-square max-w-[200px] rounded-lg overflow-hidden bg-muted">
              {shop.shopImages?.logo ? (
                <img
                  src={shop.shopImages.logo}
                  alt="Shop logo"
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-4xl">
                  🏪
                </div>
              )}
            </div>
            <label className="mt-2 inline-block">
              <Button
                type="button"
                variant="outline"
                size="sm"
                disabled={uploadingLogo}
                asChild
              >
                <span>
                  {uploadingLogo ? "Uploading..." : "Change Logo"}
                  <input
                    type="file"
                    accept="image/*"
                    onChange={handleLogoUpload}
                    className="hidden"
                  />
                </span>
              </Button>
            </label>
          </div>

          {/* Entrance Photo */}
          <div>
            <label className="block text-sm font-medium mb-2">
              Shop Entrance Photo
            </label>
            <div className="relative aspect-video max-w-[300px] rounded-lg overflow-hidden bg-muted">
              {shop.shopImages?.entrancePhoto ? (
                <img
                  src={shop.shopImages.entrancePhoto}
                  alt="Shop entrance"
                  className="w-full h-full object-cover"
                />
              ) : (
                <div className="w-full h-full flex items-center justify-center text-4xl">
                  📷
                </div>
              )}
            </div>
            <label className="mt-2 inline-block">
              <Button
                type="button"
                variant="outline"
                size="sm"
                disabled={uploadingEntrance}
                asChild
              >
                <span>
                  {uploadingEntrance ? "Uploading..." : "Change Photo"}
                  <input
                    type="file"
                    accept="image/*"
                    onChange={handleEntranceUpload}
                    className="hidden"
                  />
                </span>
              </Button>
            </label>
          </div>
        </div>
      </Card>

      {/* Shop Details Form */}
      <Card className="p-6">
        <h2 className="font-semibold mb-4">Shop Details</h2>
        <VendorForm
          initialData={{
            businessName: shop.businessName,
            businessDescription: shop.businessDescription,
            vendorType: shop.vendorType,
            stateId: shop.stateId,
            areaId: shop.areaId,
            marketId: shop.marketId,
            shopNumber: shop.shopNumber,
            shopAddress: shop.shopAddress,
            contactDetails: shop.contactDetails,
            bankDetails: shop.bankDetails,
            categories: shop.categories,
          }}
          onSubmit={handleSubmit}
          isLoading={updateVendor.isPending}
        />
      </Card>
    </div>
  );
}// src/app/(vendor)/vendor/layout.tsx
"use client";

import { useEffect } from "react";
import { useRouter } from "next/navigation";
import { useAuth } from "@/hooks";
import { VendorSidebar } from "@/components/layout";
import { LoadingState } from "@/components/common";

export default function VendorLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const router = useRouter();
  const { isLoading, isAuthenticated, isVendor } = useAuth(true);

  useEffect(() => {
    if (!isLoading && !isAuthenticated) {
      router.push("/login");
    }
  }, [isLoading, isAuthenticated, router]);

  if (isLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <LoadingState text="Loading vendor panel..." />
      </div>
    );
  }

  if (!isAuthenticated) {
    return null;
  }

  return (
    <div className="min-h-screen">
      <VendorSidebar />
      <main className="lg:pl-64">
        <div className="container-premium py-8">{children}</div>
      </main>
    </div>
  );
}

// src/app/(main)/vendor/page.tsx
// Re-export the vendor onboarding page
// The existing code at src/app/vendor/page.tsx should be here
"use client";

import { useState } from "react";
import { useRouter } from "next/navigation";
import { useAuth } from "@/hooks";
import { Card, Button } from "@/components/ui";
import { VendorForm } from "@/components/forms/vendor-form";
import { useCreateVendor } from "@/hooks/use-shops";
import { Store, CheckCircle, ArrowRight } from "lucide-react";
import Link from "next/link";

export default function VendorOnboardingPage() {
  const router = useRouter();
  const { user, isAuthenticated, isVendor } = useAuth();
  const createVendor = useCreateVendor();

  if (isVendor) {
    return (
      <div className="container-premium py-12">
        <Card className="max-w-lg mx-auto p-8 text-center">
          <div className="w-16 h-16 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center mx-auto mb-4">
            <CheckCircle className="h-8 w-8 text-green-600" />
          </div>
          <h2 className="text-2xl font-bold mb-2">You&apos;re already a vendor!</h2>
          <p className="text-muted-foreground mb-6">
            Go to your dashboard to manage your shop and products.
          </p>
          <Button asChild>
            <Link href="/vendor/dashboard">
              Go to Dashboard
              <ArrowRight className="ml-2 h-4 w-4" />
            </Link>
          </Button>
        </Card>
      </div>
    );
  }

  if (!isAuthenticated) {
    return (
      <div className="container-premium py-12">
        <Card className="max-w-lg mx-auto p-8 text-center">
          <Store className="h-16 w-16 mx-auto mb-4 text-muted-foreground" />
          <h2 className="text-2xl font-bold mb-2">Become a Vendor</h2>
          <p className="text-muted-foreground mb-6">
            Create an account or sign in to start selling on SureShops.
          </p>
          <div className="flex gap-4 justify-center">
            <Button variant="outline" asChild>
              <Link href="/login">Sign In</Link>
            </Button>
            <Button asChild>
              <Link href="/register">Create Account</Link>
            </Button>
          </div>
        </Card>
      </div>
    );
  }

  const handleSubmit = async (data: any) => {
    try {
      await createVendor.mutateAsync(data);
      router.push("/vendor/dashboard");
    } catch (error) {
      // handled by mutation
    }
  };

  return (
    <div className="container-premium py-12">
      <div className="max-w-2xl mx-auto">
        <div className="text-center mb-8">
          <h1 className="text-3xl font-bold mb-2">Become a Vendor</h1>
          <p className="text-muted-foreground">
            Set up your shop and start selling to thousands of customers
          </p>
        </div>
        <Card className="p-6">
          <VendorForm
            onSubmit={handleSubmit}
            isLoading={createVendor.isPending}
          />
        </Card>
      </div>
    </div>
  );
}
"use client";

import { useState } from "react";
import Image from "next/image";
import Link from "next/link";
import {
  ChevronLeft,
  ChevronRight,
  Share2,
  Heart,
  Store,
  MapPin,
  Phone,
  MessageCircle,
} from "lucide-react";
import { Button, Card, Badge } from "@/components/ui";
import {
  BackButton,
  PriceTag,
  Rating,
  VerifiedBadge,
  LoadingState,
} from "@/components/common";
import { PriceComparison } from "@/components/products";
import { useProduct } from "@/hooks";
import { searchService } from "@/services";
import { useQuery } from "@tanstack/react-query";

interface ProductPageProps {
  params: { id: string };
}

export default function ProductPage({ params }: ProductPageProps) {
  const { data: product, isLoading } = useProduct(params.id);
  const [currentImageIndex, setCurrentImageIndex] = useState(0);
  const [showAllVendors, setShowAllVendors] = useState(false);

  // Fetch vendors selling this product
  const { data: productVendors } = useQuery({
    queryKey: ["product-vendors", product?.name],
    queryFn: () => searchService.getProductVendors(product!.name),
    enabled: !!product?.name,
  });

  // Fetch similar products
  const { data: similarProducts } = useQuery({
    queryKey: ["similar-products", params.id],
    queryFn: () => searchService.getSimilarProducts(params.id),
    enabled: !!params.id,
  });

  if (isLoading) {
    return (
      <div className="container-premium py-6">
        <LoadingState />
      </div>
    );
  }

  if (!product) {
    return (
      <div className="container-premium py-6">
        <p>Product not found</p>
      </div>
    );
  }

  const images = product.images?.length > 0 ? product.images : ["/placeholder.jpg"];
  const vendor = product.vendorId as any;

  return (
    <div className="container-premium py-6">
      <BackButton className="mb-6" />

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
        {/* Image Gallery */}
        <div className="space-y-4">
          <div className="relative aspect-square rounded-2xl overflow-hidden bg-muted">
            <Image
              src={images[currentImageIndex]}
              alt={product.name}
              fill
              className="object-cover"
              priority
            />

            {/* Navigation Arrows */}
            {images.length > 1 && (
              <>
                <button
                  onClick={() =>
                    setCurrentImageIndex((prev) =>
                      prev === 0 ? images.length - 1 : prev - 1
                    )
                  }
                  className="absolute left-4 top-1/2 -translate-y-1/2 p-2 rounded-full bg-background/80 hover:bg-background transition-colors"
                >
                  <ChevronLeft className="h-5 w-5" />
                </button>
                <button
                  onClick={() =>
                    setCurrentImageIndex((prev) =>
                      prev === images.length - 1 ? 0 : prev + 1
                    )
                  }
                  className="absolute right-4 top-1/2 -translate-y-1/2 p-2 rounded-full bg-background/80 hover:bg-background transition-colors"
                >
                  <ChevronRight className="h-5 w-5" />
                </button>
              </>
            )}

            {/* Stock Badge */}
            {!product.inStock && (
              <Badge variant="destructive" className="absolute top-4 left-4">
                Out of Stock
              </Badge>
            )}
          </div>

          {/* Thumbnails */}
          {images.length > 1 && (
            <div className="flex gap-2 overflow-x-auto no-scrollbar">
              {images.map((image, index) => (
                <button
                  key={index}
                  onClick={() => setCurrentImageIndex(index)}
                  className={`relative w-20 h-20 rounded-lg overflow-hidden flex-shrink-0 border-2 transition-colors ${
                    index === currentImageIndex
                      ? "border-primary"
                      : "border-transparent"
                  }`}
                >
                  <Image
                    src={image}
                    alt={`${product.name} ${index + 1}`}
                    fill
                    className="object-cover"
                  />
                </button>
              ))}
            </div>
          )}
        </div>

        {/* Product Info */}
        <div className="space-y-6">
          {/* Header */}
          <div>
            {product.brand && (
              <p className="text-sm text-muted-foreground mb-1">{product.brand}</p>
            )}
            <h1 className="text-2xl md:text-3xl font-bold">{product.name}</h1>

            {/* Category */}
            <div className="flex items-center gap-2 mt-2">
              <Badge variant="secondary">{product.category}</Badge>
              {product.subcategory && (
                <Badge variant="outline">{product.subcategory}</Badge>
              )}
            </div>
          </div>

          {/* Price */}
          <div className="pb-6 border-b border-border">
            <PriceTag
              price={product.price}
              originalPrice={product.originalPrice}
              size="lg"
            />
            {productVendors && productVendors.totalVendors > 1 && (
              <p className="text-sm text-muted-foreground mt-2">
                Available from {productVendors.totalVendors} vendors •
                Prices from {productVendors.priceRange.lowest.toLocaleString()} to{" "}
                {productVendors.priceRange.highest.toLocaleString()} NGN
              </p>
            )}
          </div>

          {/* Vendor Card */}
          {vendor && (
            <Card className="p-4">
              <div className="flex items-start gap-4">
                <div className="w-16 h-16 rounded-lg bg-muted overflow-hidden flex-shrink-0">
                  {vendor.shopImages?.logo ? (
                    <Image
                      src={vendor.shopImages.logo}
                      alt={vendor.businessName}
                      width={64}
                      height={64}
                      className="object-cover w-full h-full"
                    />
                  ) : (
                    <div className="w-full h-full flex items-center justify-center text-2xl">
                      🏪
                    </div>
                  )}
                </div>
                <div className="flex-1 min-w-0">
                  <div className="flex items-center gap-2">
                    <Link
                      href={`/shops/${vendor._id}`}
                      className="font-semibold hover:text-primary transition-colors"
                    >
                      {vendor.businessName}
                    </Link>
                    {vendor.isVerified && <VerifiedBadge size="sm" />}
                  </div>
                  <Rating value={vendor.rating || 0} size="sm" className="mt-1" />
                  <div className="flex items-center gap-1 text-sm text-muted-foreground mt-1">
                    <MapPin className="h-4 w-4" />
                    <span className="truncate">
                      {vendor.shopNumber && `${vendor.shopNumber}, `}
                      {vendor.marketId?.name || vendor.areaId?.name}
                    </span>
                  </div>
                </div>
              </div>

              {/* Contact Actions */}
              <div className="flex gap-2 mt-4">
                <Button
                  className="flex-1"
                  onClick={() => window.open(`tel:${vendor.contactDetails.phone}`)}
                >
                  <Phone className="mr-2 h-4 w-4" />
                  Call
                </Button>
                {vendor.contactDetails.whatsapp && (
                  <Button
                    variant="outline"
                    className="flex-1"
                    onClick={() =>
                      window.open(
                        `https://wa.me/${vendor.contactDetails.whatsapp?.replace(
                          /\D/g,
                          ""
                        )}`
                      )
                    }
                  >
                    <MessageCircle className="mr-2 h-4 w-4" />
                    WhatsApp
                  </Button>
                )}
                <Button
                  variant="ghost"
                  size="icon"
                  onClick={() => {
                    navigator.share?.({
                      title: product.name,
                      url: window.location.href,
                    });
                  }}
                >
                  <Share2 className="h-4 w-4" />
                </Button>
                <Button variant="ghost" size="icon">
                  <Heart className="h-4 w-4" />
                </Button>
              </div>
            </Card>
          )}

          {/* Description */}
          {product.description && (
            <div>
              <h3 className="font-semibold mb-2">Description</h3>
              <p className="text-muted-foreground">{product.description}</p>
            </div>
          )}

          {/* Specifications */}
          {product.specifications && Object.keys(product.specifications).length > 0 && (
            <div>
              <h3 className="font-semibold mb-2">Specifications</h3>
              <div className="grid grid-cols-2 gap-2 text-sm">
                {Object.entries(product.specifications).map(([key, value]) => (
                  <div key={key} className="flex justify-between p-2 bg-muted/50 rounded-lg">
                    <span className="text-muted-foreground">{key}</span>
                    <span className="font-medium">{String(value)}</span>
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Price Comparison */}
      {productVendors && productVendors.vendors.length > 1 && (
        <div className="mt-12">
          <PriceComparison
            vendors={showAllVendors ? productVendors.vendors : productVendors.vendors.slice(0, 5)}
          />
          {productVendors.vendors.length > 5 && !showAllVendors && (
            <div className="text-center mt-4">
              <Button variant="outline" onClick={() => setShowAllVendors(true)}>
                Show All {productVendors.vendors.length} Vendors
              </Button>
            </div>
          )}
        </div>
      )}
    </div>
  );
}"use client";

import { useState } from "react";
import { useQuery } from "@tanstack/react-query";
import { Search } from "lucide-react";
import { Input, Button, Card } from "@/components/ui";
import { BackButton, LoadingState, EmptyState } from "@/components/common";
import { PriceComparison } from "@/components/products";
import { searchService } from "@/services";
import { Package } from "lucide-react";

export default function ComparePage() {
  const [searchQuery, setSearchQuery] = useState("");
  const [submittedQuery, setSubmittedQuery] = useState("");

  const { data, isLoading } = useQuery({
    queryKey: ["product-compare", submittedQuery],
    queryFn: () => searchService.getProductVendors(submittedQuery),
    enabled: !!submittedQuery,
  });

  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault();
    if (searchQuery.trim()) {
      setSubmittedQuery(searchQuery.trim());
    }
  };

  return (
    <div className="container-premium py-6">
      <BackButton className="mb-6" />

      <div className="max-w-3xl mx-auto">
        <div className="text-center mb-8">
          <h1 className="text-3xl font-bold mb-2">Compare Prices</h1>
          <p className="text-muted-foreground">
            Search for a product to compare prices across different vendors
          </p>
        </div>

        {/* Search Form */}
        <Card className="p-6 mb-8">
          <form onSubmit={handleSearch} className="flex gap-4">
            <div className="flex-1 relative">
              <Search className="absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground" />
              <Input
                type="text"
                placeholder="Enter product name (e.g., iPhone 15 Pro Max)"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                className="pl-12 h-12"
              />
            </div>
            <Button type="submit" size="lg" disabled={!searchQuery.trim()}>
              Compare
            </Button>
          </form>
        </Card>

        {/* Results */}
        {isLoading ? (
          <LoadingState text="Finding prices..." />
        ) : data ? (
          <div className="space-y-6">
            <div className="text-center">
              <h2 className="text-xl font-semibold">{data.name}</h2>
              {data.brand && (
                <p className="text-muted-foreground">{data.brand}</p>
              )}
              <div className="mt-2 flex justify-center gap-4 text-sm">
                <span>
                  <strong className="text-green-600">
                    ₦{data.priceRange.lowest.toLocaleString()}
                  </strong>{" "}
                  lowest
                </span>
                <span>
                  <strong>₦{data.priceRange.average.toLocaleString()}</strong>{" "}
                  average
                </span>
                <span>
                  <strong className="text-red-600">
                    ₦{data.priceRange.highest.toLocaleString()}
                  </strong>{" "}
                  highest
                </span>
              </div>
            </div>

            <PriceComparison vendors={data.vendors} />
          </div>
        ) : submittedQuery ? (
          <EmptyState
            icon={<Package className="h-10 w-10" />}
            title="No results found"
            description={`No vendors found selling "${submittedQuery}"`}
          />
        ) : (
          <div className="text-center py-12">
            <Package className="h-16 w-16 mx-auto text-muted-foreground mb-4" />
            <p className="text-muted-foreground">
              Enter a product name to see price comparisons
            </p>
          </div>
        )}
      </div>
    </div>
  );
}// src/app/(main)/search/page.tsx
"use client";

import { Suspense } from "react";
import { LoadingState } from "@/components/common";
import { SearchPageContent } from "./search-content";

export default function SearchPage() {
  return (
    <Suspense fallback={<LoadingState text="Loading search..." />}>
      <SearchPageContent />
    </Suspense>
  );
}// src/app/(main)/search/search-content.tsx
"use client";

import { useSearchParams } from "next/navigation";
import { useEffect, useState, useRef } from "react";
import { SearchBar, SearchFilters, SearchResults } from "@/components/search";
import { BackButton, LoadingState } from "@/components/common";
import { useSearch } from "@/hooks";
import { SearchType } from "@/types";

export function SearchPageContent() {
  const searchParams = useSearchParams();
  const initializedRef = useRef(false);

  const initialQuery = searchParams.get("query") || "";
  const initialStateId = searchParams.get("stateId") || "";
  const initialAreaId = searchParams.get("areaId") || "";
  const initialMarketId = searchParams.get("marketId") || "";
  const initialSearchType =
    (searchParams.get("searchType") as SearchType) || "all";

  const {
    query,
    filters,
    results,
    isLoading,
    setQuery,
    updateFilter,
    clearFilters,
  } = useSearch();

  const [searchType, setSearchType] = useState<SearchType>(initialSearchType);

  // Initialize from URL params once
  useEffect(() => {
    if (initializedRef.current) return;
    initializedRef.current = true;

    if (initialQuery) setQuery(initialQuery);
    if (initialStateId) updateFilter("stateId", initialStateId);
    if (initialAreaId) updateFilter("areaId", initialAreaId);
    if (initialMarketId) updateFilter("marketId", initialMarketId);
    if (initialSearchType !== "all")
      updateFilter("searchType", initialSearchType);
  }, []);

  const handlePageChange = (page: number) => {
    updateFilter("page", page);
    window.scrollTo({ top: 0, behavior: "smooth" });
  };

  const handleSearchTypeChange = (type: SearchType) => {
    setSearchType(type);
    updateFilter("searchType", type);
  };

  return (
    <div className="container-premium py-6">
      <div className="mb-6">
        <BackButton />
      </div>

      <div className="mb-6">
        <SearchBar
          placeholder="Search products, shops, brands..."
          autoFocus={!initialQuery}
        />
      </div>

      <SearchFilters
        filters={filters}
        availableFilters={results?.availableFilters}
        onFilterChange={updateFilter}
        onClearFilters={clearFilters}
        className="mb-6"
      />

      <SearchResults
        results={results}
        isLoading={isLoading}
        searchType={searchType}
        onSearchTypeChange={handleSearchTypeChange}
        onPageChange={handlePageChange}
        currentPage={filters.page || 1}
      />
    </div>
  );
}
// src/app/(main)/page.tsx
import { Metadata } from "next";
import Link from "next/link";
import { ArrowRight, MapPin, Store, TrendingUp, Shield, Search } from "lucide-react";
import { Button, Card } from "@/components/ui";
import { HomeSearch } from "@/components/search/home-search";
import { CATEGORIES } from "@/lib/constants";

export const metadata: Metadata = {
  title: "SureShops - Find Products, Compare Prices",
};

export default function HomePage() {
  return (
    <div>
      {/* Hero Section */}
      <section className="relative bg-gradient-to-b from-muted/50 to-background pt-12 pb-20">
        <div className="container-premium">
          <div className="max-w-3xl mx-auto text-center">
            <h1 className="text-4xl md:text-5xl lg:text-6xl font-bold tracking-tight">
              Find Products.{" "}
              <span className="text-muted-foreground">Compare Prices.</span>
            </h1>
            <p className="mt-6 text-lg text-muted-foreground max-w-2xl mx-auto">
              Set your location, search for any product, and instantly see every
              shop in the market that has it — with prices, shop numbers, and
              directions.
            </p>

            {/* Location-First Search */}
            <div className="mt-10 max-w-2xl mx-auto">
              <HomeSearch />
            </div>

            {/* Quick Links */}
            <div className="mt-8 flex flex-wrap justify-center gap-3">
              {["iPhone", "Laptop", "Shoes", "Electronics", "Fashion"].map(
                (term) => (
                  <Link
                    key={term}
                    href={`/search?query=${term}`}
                    className="px-4 py-2 rounded-full bg-muted text-sm hover:bg-muted/80 transition-colors"
                  >
                    {term}
                  </Link>
                )
              )}
            </div>
          </div>
        </div>
      </section>

      {/* How It Works */}
      <section className="py-16">
        <div className="container-premium">
          <h2 className="text-2xl font-bold text-center mb-10">
            How SureShops Works
          </h2>
          <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
            {[
              {
                step: "1",
                icon: <MapPin className="h-6 w-6" />,
                title: "Select Your Market",
                desc: "Choose your state, area, and the market you're visiting",
              },
              {
                step: "2",
                icon: <Search className="h-6 w-6" />,
                title: "Search a Product",
                desc: "Type the product you're looking for",
              },
              {
                step: "3",
                icon: <TrendingUp className="h-6 w-6" />,
                title: "Compare Prices",
                desc: "See all shops with that product and their prices",
              },
              {
                step: "4",
                icon: <Store className="h-6 w-6" />,
                title: "Visit the Shop",
                desc: "Get the shop number, floor, and directions",
              },
            ].map((item) => (
              <Card key={item.step} className="p-6 text-center relative">
                <div className="absolute -top-3 left-1/2 -translate-x-1/2 w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-sm font-bold">
                  {item.step}
                </div>
                <div className="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4 mt-2">
                  {item.icon}
                </div>
                <h3 className="font-semibold text-lg">{item.title}</h3>
                <p className="text-muted-foreground mt-2 text-sm">
                  {item.desc}
                </p>
              </Card>
            ))}
          </div>
        </div>
      </section>

      {/* Features */}
      <section className="py-16 bg-muted/30">
        <div className="container-premium">
          <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
            <Card className="p-6 text-center">
              <div className="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4">
                <TrendingUp className="h-6 w-6" />
              </div>
              <h3 className="font-semibold text-lg">Compare Prices</h3>
              <p className="text-muted-foreground mt-2 text-sm">
                See prices from multiple vendors in the same market instantly
              </p>
            </Card>
            <Card className="p-6 text-center">
              <div className="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4">
                <MapPin className="h-6 w-6" />
              </div>
              <h3 className="font-semibold text-lg">Find Exact Shop</h3>
              <p className="text-muted-foreground mt-2 text-sm">
                Get shop numbers, floor, block, and landmark directions
              </p>
            </Card>
            <Card className="p-6 text-center">
              <div className="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4">
                <Shield className="h-6 w-6" />
              </div>
              <h3 className="font-semibold text-lg">Verified Vendors</h3>
              <p className="text-muted-foreground mt-2 text-sm">
                Shop with confidence from verified local businesses
              </p>
            </Card>
          </div>
        </div>
      </section>

      {/* Categories */}
      <section className="py-16">
        <div className="container-premium">
          <div className="flex items-center justify-between mb-8">
            <div>
              <h2 className="text-2xl font-bold">Browse Categories</h2>
              <p className="text-muted-foreground mt-1">
                Explore products by category
              </p>
            </div>
            <Button variant="ghost" asChild>
              <Link href="/categories">
                View All
                <ArrowRight className="ml-2 h-4 w-4" />
              </Link>
            </Button>
          </div>
          <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
            {CATEGORIES.slice(0, 10).map((category) => (
              <Link
                key={category.slug}
                href={`/categories/${category.slug}`}
                className="group"
              >
                <Card className="p-6 text-center hover:shadow-lg transition-all">
                  <span className="text-3xl mb-3 block">{category.icon}</span>
                  <h3 className="font-medium group-hover:text-primary transition-colors">
                    {category.name}
                  </h3>
                </Card>
              </Link>
            ))}
          </div>
        </div>
      </section>

      {/* CTA */}
      <section className="py-20">
        <div className="container-premium">
          <Card className="bg-foreground text-background p-12 text-center">
            <Store className="h-12 w-12 mx-auto mb-6" />
            <h2 className="text-3xl font-bold">Are you a vendor?</h2>
            <p className="mt-4 text-background/80 max-w-xl mx-auto">
              Join thousands of vendors on SureShops. List your products, reach
              more customers, and grow your business.
            </p>
            <Button
              size="lg"
              className="mt-8 bg-background text-foreground hover:bg-background/90"
              asChild
            >
              <Link href="/vendor">
                Start Selling
                <ArrowRight className="ml-2 h-5 w-5" />
              </Link>
            </Button>
          </Card>
        </div>
      </section>
    </div>
  );
}
// src/app/(main)/layout.tsx
import { Header, Footer, MobileNav } from "@/components/layout";

export default function MainLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <>
      <Header />
      <main className="min-h-screen pb-16 md:pb-0">{children}</main>
      <Footer />
      <MobileNav />
    </>
  );
}
// src/app/(main)/shops/[id]/page.tsx
"use client";

import { useState } from "react";
import Image from "next/image";
import Link from "next/link";
import { useQuery } from "@tanstack/react-query";
import {
  Phone,
  MessageCircle,
  Share2,
  Heart,
  MapPin,
  Package,
} from "lucide-react";
import { Button, Card, Badge } from "@/components/ui";
import {
  BackButton,
  Rating,
  VerifiedBadge,
  LoadingState,
  EmptyState,
  Pagination,
} from "@/components/common";
import { ShopContact, ShopLocation } from "@/components/shops";
import { ProductGrid } from "@/components/products";
import { vendorService, searchService } from "@/services";
import { useToggleFavorite } from "@/hooks/use-favorites";
import { FavoriteType } from "@/types/favorites";
import { formatPrice, isOpen as checkIsOpen } from "@/lib/utils";

interface ShopPageProps {
  params: { id: string };
}

export default function ShopPage({ params }: ShopPageProps) {
  const [productPage, setProductPage] = useState(1);
  const [selectedCategory, setSelectedCategory] = useState("");
  const toggleFavorite = useToggleFavorite();

  const { data: shop, isLoading: shopLoading } = useQuery({
    queryKey: ["shop", params.id],
    queryFn: () => vendorService.getById(params.id),
  });

  const { data: shopProducts, isLoading: productsLoading } = useQuery({
    queryKey: ["shop-products", params.id, productPage, selectedCategory],
    queryFn: () =>
      searchService.getShopProducts(params.id, {
        page: productPage,
        // limit: 12,
        category: selectedCategory || undefined,
      }),
    enabled: !!params.id,
  });

  if (shopLoading) {
    return (
      <div className="container-premium py-6">
        <LoadingState />
      </div>
    );
  }

  if (!shop) {
    return (
      <div className="container-premium py-6">
        <BackButton className="mb-6" />
        <EmptyState
          icon={<Package className="h-10 w-10" />}
          title="Shop not found"
          description="This shop may have been removed or does not exist"
        />
      </div>
    );
  }

  // Extract populated refs
  const stateRef = shop.stateId as any;
  const areaRef = shop.areaId as any;
  const marketRef = shop.marketId as any;

  const stateName =
    typeof stateRef === "object" && stateRef ? stateRef.name : "";
  const areaName =
    typeof areaRef === "object" && areaRef ? areaRef.name : "";
  const marketName =
    typeof marketRef === "object" && marketRef ? marketRef.name : "";
  const marketType =
    typeof marketRef === "object" && marketRef ? marketRef.type : "";

  const shopIsOpen = shop.operatingHours
    ? checkIsOpen(
        shop.operatingHours.openingTime,
        shop.operatingHours.closingTime
      )
    : true;

  const locationInfo = {
    state: {
      id: typeof stateRef === "object" ? stateRef?.id || "" : stateRef || "",
      name: stateName,
    },
    area: {
      id: typeof areaRef === "object" ? areaRef?.id || "" : areaRef || "",
      name: areaName,
    },
    market: marketRef
      ? {
          id:
            typeof marketRef === "object"
              ? marketRef?.id || ""
              : marketRef || "",
          name: marketName,
          type: marketType,
        }
      : undefined,
    shopNumber: shop.shopNumber,
    shopFloor: shop.shopFloor,
    shopBlock: shop.shopBlock,
    shopAddress: shop.shopAddress,
    landmark: shop.landmark,
    coordinates: shop.location?.coordinates,
  };

  return (
    <div className="container-premium py-6">
      <BackButton className="mb-6" />

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {/* Main content */}
        <div className="lg:col-span-2 space-y-6">
          {/* Cover image */}
          <div className="relative">
            <div className="relative h-48 md:h-64 rounded-2xl overflow-hidden bg-muted">
              {shop.shopImages?.entrancePhoto ? (
                <Image
                  src={shop.shopImages.entrancePhoto}
                  alt={shop.businessName}
                  fill
                  className="object-cover"
                  priority
                />
              ) : (
                <div className="flex h-full items-center justify-center bg-gradient-to-br from-muted to-muted/50">
                  <span className="text-6xl">🏪</span>
                </div>
              )}
              <div className="absolute top-4 right-4">
                <Badge variant={shopIsOpen ? "success" : "secondary"}>
                  {shopIsOpen ? "Open Now" : "Closed"}
                </Badge>
              </div>
              {shop.isFeatured && (
                <div className="absolute top-4 left-4">
                  <Badge variant="default">⭐ Featured</Badge>
                </div>
              )}
            </div>

            {/* Logo */}
            <div className="absolute -bottom-8 left-6">
              <div className="w-20 h-20 rounded-xl border-4 border-background bg-muted overflow-hidden shadow-lg">
                {shop.shopImages?.logo ? (
                  <Image
                    src={shop.shopImages.logo}
                    alt={shop.businessName}
                    width={80}
                    height={80}
                    className="object-cover w-full h-full"
                  />
                ) : (
                  <div className="w-full h-full flex items-center justify-center text-3xl bg-primary/10">
                    🏪
                  </div>
                )}
              </div>
            </div>
          </div>

          {/* Shop details */}
          <div className="pt-10">
            <div className="flex items-start justify-between">
              <div>
                <div className="flex items-center gap-2">
                  <h1 className="text-2xl md:text-3xl font-bold">
                    {shop.businessName}
                  </h1>
                  {shop.isVerified && <VerifiedBadge size="lg" />}
                </div>
                <div className="flex items-center gap-4 mt-2">
                  <Rating
                    value={shop.rating || 0}
                    count={shop.reviewCount}
                    size="md"
                  />
                  <Badge variant="outline">
                    {shop.vendorType?.replace(/_/g, " ")}
                  </Badge>
                </div>
                <div className="flex items-center gap-1 text-muted-foreground mt-2">
                  <MapPin className="h-4 w-4" />
                  <span>
                    {shop.shopNumber && `${shop.shopNumber}, `}
                    {marketName || areaName}
                    {stateName && `, ${stateName}`}
                  </span>
                </div>
              </div>
              <div className="flex gap-2">
                <Button
                  variant="outline"
                  size="icon"
                  onClick={() =>
                    navigator.share?.({
                      title: shop.businessName,
                      url: window.location.href,
                    })
                  }
                >
                  <Share2 className="h-4 w-4" />
                </Button>
                <Button
                  variant="outline"
                  size="icon"
                  onClick={() =>
                    toggleFavorite.mutate({
                      type: FavoriteType.VENDOR,
                      itemId: shop.id,
                    })
                  }
                >
                  <Heart className="h-4 w-4" />
                </Button>
              </div>
            </div>

            {shop.businessDescription && (
              <p className="mt-4 text-muted-foreground">
                {shop.businessDescription}
              </p>
            )}

            {/* Stats */}
            <div className="flex gap-6 mt-4 text-sm">
              <div>
                <span className="font-bold text-lg">{shop.totalProducts}</span>
                <span className="text-muted-foreground ml-1">Products</span>
              </div>
              <div>
                <span className="font-bold text-lg">{shop.totalViews}</span>
                <span className="text-muted-foreground ml-1">Views</span>
              </div>
              {shop.minProductPrice > 0 && (
                <div>
                  <span className="text-muted-foreground">From </span>
                  <span className="font-bold">
                    {formatPrice(shop.minProductPrice)}
                  </span>
                </div>
              )}
            </div>

            {/* Categories */}
            {shop.categories && shop.categories.length > 0 && (
              <div className="flex flex-wrap gap-2 mt-4">
                {shop.categories.map((cat: string) => (
                  <Badge key={cat} variant="secondary">
                    {cat}
                  </Badge>
                ))}
              </div>
            )}
          </div>

          {/* Products */}
          <div className="pt-6 border-t border-border">
            <div className="flex items-center justify-between mb-4 flex-wrap gap-2">
              <h2 className="text-xl font-semibold">Products</h2>
              {shop.categories && shop.categories.length > 0 && (
                <div className="flex gap-2 overflow-x-auto no-scrollbar">
                  <Button
                    size="sm"
                    variant={!selectedCategory ? "default" : "outline"}
                    onClick={() => {
                      setSelectedCategory("");
                      setProductPage(1);
                    }}
                  >
                    All
                  </Button>
                  {shop.categories.map((cat: string) => (
                    <Button
                      key={cat}
                      size="sm"
                      variant={
                        selectedCategory === cat ? "default" : "outline"
                      }
                      onClick={() => {
                        setSelectedCategory(cat);
                        setProductPage(1);
                      }}
                    >
                      {cat}
                    </Button>
                  ))}
                </div>
              )}
            </div>

            {productsLoading ? (
              <LoadingState />
            ) : (
              <>
                <ProductGrid
                  products={shopProducts?.products || []}
                  emptyMessage="No products listed yet"
                />
                {shopProducts && shopProducts.totalPages > 1 && (
                  <Pagination
                    currentPage={productPage}
                    totalPages={shopProducts.totalPages}
                    onPageChange={setProductPage}
                    className="mt-6"
                  />
                )}
              </>
            )}
          </div>
        </div>

        {/* Sidebar */}
        <div className="space-y-6">
          {/* Quick contact */}
          <Card className="p-4">
            <div className="flex gap-2">
              <Button
                className="flex-1"
                onClick={() =>
                  window.open(`tel:${shop.contactDetails.phone}`)
                }
              >
                <Phone className="mr-2 h-4 w-4" />
                Call
              </Button>
              {shop.contactDetails.whatsapp && (
                <Button
                  variant="outline"
                  className="flex-1"
                  onClick={() =>
                    window.open(
                      `https://wa.me/${shop.contactDetails.whatsapp?.replace(/\D/g, "")}`
                    )
                  }
                >
                  <MessageCircle className="mr-2 h-4 w-4" />
                  WhatsApp
                </Button>
              )}
            </div>
          </Card>

          <ShopLocation
            location={locationInfo}
            operatingHours={shop.operatingHours}
          />

          <ShopContact
            contactDetails={shop.contactDetails}
            bankDetails={shop.bankDetails}
          />
        </div>
      </div>
    </div>
  );
}
"use client";

import { useState } from "react";
import { useQuery } from "@tanstack/react-query";
import { BackButton, Pagination, LoadingState } from "@/components/common";
import { ShopGrid } from "@/components/shops";
import { LocationFilter } from "@/components/search";
import { Select, Input, Button, Card } from "@/components/ui";
import { vendorService } from "@/services";
import { Search, SlidersHorizontal } from "lucide-react";
import { VENDOR_TYPES } from "@/lib/constants";
import { vendorToDisplayData } from "@/types/shop-display";

export default function ShopsPage() {
  const [page, setPage] = useState(1);
  const [search, setSearch] = useState("");
  const [filters, setFilters] = useState<any>({});
  const [showFilters, setShowFilters] = useState(false);

  const { data, isLoading } = useQuery({
    queryKey: ["shops", page, search, filters],
    queryFn: () =>
      vendorService.getAll({
        page,
        limit: 12,
        search: search || undefined,
        ...filters,
      }),
  });

  const handleSearch = (e: React.FormEvent) => {
    e.preventDefault();
    setPage(1);
  };

  return (
    <div className="container-premium py-6">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">All Shops</h1>
        <p className="text-muted-foreground mt-1">
          Discover local shops and vendors
        </p>
      </div>

      {/* Search & Filters */}
      <Card className="p-4 mb-6">
        <form onSubmit={handleSearch} className="flex gap-4 flex-wrap">
          <div className="flex-1 min-w-[200px] relative">
            <Search className="absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground" />
            <Input
              placeholder="Search shops..."
              value={search}
              onChange={(e) => setSearch(e.target.value)}
              className="pl-10"
            />
          </div>

          <LocationFilter
            stateId={filters.stateId}
            areaId={filters.areaId}
            marketId={filters.marketId}
            onStateChange={(id) => setFilters((f: any) => ({ ...f, stateId: id, areaId: undefined, marketId: undefined }))}
            onAreaChange={(id) => setFilters((f: any) => ({ ...f, areaId: id, marketId: undefined }))}
            onMarketChange={(id) => setFilters((f: any) => ({ ...f, marketId: id }))}
          />

          <Select
            value={filters.vendorType || ""}
            onChange={(value) => setFilters((f: any) => ({ ...f, vendorType: value || undefined }))}
            options={[{ value: "", label: "All Types" }, ...VENDOR_TYPES]}
            className="w-40"
          />

          <Button
            type="button"
            variant="outline"
            onClick={() => setShowFilters(!showFilters)}
          >
            <SlidersHorizontal className="h-4 w-4 mr-2" />
            Filters
          </Button>
        </form>

        {showFilters && (
          <div className="mt-4 pt-4 border-t border-border flex flex-wrap gap-4">
            <label className="flex items-center gap-2 cursor-pointer">
              <input
                type="checkbox"
                checked={filters.isVerified === true}
                onChange={(e) =>
                  setFilters((f: any) => ({
                    ...f,
                    isVerified: e.target.checked || undefined,
                  }))
                }
                className="rounded border-input"
              />
              <span className="text-sm">Verified Only</span>
            </label>
            <label className="flex items-center gap-2 cursor-pointer">
              <input
                type="checkbox"
                checked={filters.isFeatured === true}
                onChange={(e) =>
                  setFilters((f: any) => ({
                    ...f,
                    isFeatured: e.target.checked || undefined,
                  }))
                }
                className="rounded border-input"
              />
              <span className="text-sm">Featured Only</span>
            </label>
            <Button
              variant="ghost"
              size="sm"
              onClick={() => {
                setFilters({});
                setSearch("");
                setPage(1);
              }}
            >
              Clear All
            </Button>
          </div>
        )}
      </Card>

      {/* Results */}
      {isLoading ? (
        <LoadingState />
      ) : (
        <>
          <div className="mb-4 text-sm text-muted-foreground">
            {data?.total || 0} shops found
          </div>
          <ShopGrid  shops={(data?.vendors || []).map(vendorToDisplayData)} />
          {data && data.totalPages > 1 && (
            <Pagination
              currentPage={page}
              totalPages={data.totalPages}
              onPageChange={setPage}
              className="mt-8"
            />
          )}
        </>
      )}
    </div>
  );
}